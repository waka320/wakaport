@use "sass:color";
@use "sass:math";
@use 'themes/light-theme';
@use 'themes/dark-theme';
@use 'components/typography';
@use 'components/grid-background';

@tailwind base;
@tailwind components;
@tailwind utilities;


$breakpoints: (
    'sm': 576px,
    'md': 768px,
    'lg': 992px,
    'xl': 1200px
);

/* モバイル最適化用追加スタイル */
html {
    -webkit-text-size-adjust: 100%;
    touch-action: manipulation;
}

body {
    /* モバイル用スクロールのスムージング */
    -webkit-overflow-scrolling: touch;
    font-family: var(--font-pixel-14), var(--font-pixel-12), var(--font-pixel-16), system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    image-rendering: pixelated;
}

/* モバイルのベース文字サイズを少し大きく */
@media (max-width: 768px) {
    body {
        font-size: 17px;
        line-height: 1.65;
    }
}

/* CRT scanline utility */
.crt-overlay::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: repeating-linear-gradient(0deg,
            rgba(0, 0, 0, 0.15) 0px,
            rgba(0, 0, 0, 0.15) 1px,
            transparent 1px,
            transparent 3px);
    mix-blend-mode: multiply;
    opacity: 0.25;
}

/* ダークテーマではスキャンラインのコントラストと色成分を強化 */
.dark .crt-overlay::after {
    background:
        linear-gradient(rgba(255, 255, 255, 0.02) 50%, rgba(0, 0, 0, 0.38) 50%),
        linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.03), rgba(0, 0, 255, 0.06));
    background-size: 100% 2px, 3px 100%;
    mix-blend-mode: overlay;
    opacity: 0.38;
}

/* 粒状ノイズの前景レイヤー（フィルムグレイン） */
.crt-overlay::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background-image:
        radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        radial-gradient(circle at 70% 80%, rgba(0, 0, 0, 0.03) 1px, transparent 1px);
    background-size: 5px 5px, 8px 8px;
    background-position: 0 0, 2px 2px;
    mix-blend-mode: soft-light;
    opacity: 0.5;
    animation: crt-flicker 7s ease-in-out infinite;
}

.dark .crt-overlay::before {
    background-image:
        radial-gradient(circle at 15% 25%, rgba(255, 255, 255, 0.05) 1px, transparent 1px),
        radial-gradient(circle at 65% 75%, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
    opacity: 0.26;
    mix-blend-mode: screen;
}

@keyframes crt-flicker {

    0%,
    100% {
        opacity: var(--crt-opacity, 1);
        filter: none;
    }

    10% {
        opacity: calc(var(--crt-opacity, 1) - 0.04);
    }

    45% {
        opacity: calc(var(--crt-opacity, 1) - 0.02);
    }

    55% {
        opacity: var(--crt-opacity, 1);
    }

    70% {
        opacity: calc(var(--crt-opacity, 1) - 0.03);
    }
}

/* Composite glow utility for retro UI */
.neon-composite {
    position: relative;
}

.neon-composite::before {
    content: "";
    position: absolute;
    inset: -2px;
    filter: blur(4px);
    background: radial-gradient(closest-side, rgba(0, 209, 255, 0.25), transparent 70%),
        radial-gradient(closest-side, rgba(57, 255, 20, 0.18), transparent 60%);
    mix-blend-mode: screen;
    pointer-events: none;
}

/* Pixel panel border like retro UI */
.pixel-panel {
    position: relative;
    border: 2px solid #000;
    box-shadow: 2px 2px 0 0 #000;
}

.dark .pixel-panel {
    border-color: #e6f1ff;
    box-shadow: 2px 2px 0 0 #e6f1ff;
}

/* Decorative title styles */
.title-pop {
    display: inline-block;
    animation: riseIn 2800ms cubic-bezier(0.23, 1, 0.32, 1) both;
}

.name-text {
    background: linear-gradient(90deg, var(--name-primary), var(--name-secondary));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    position: relative;
}

.name-text::before {
    content: "WakamatsuYuki";
    position: absolute;
    left: 0;
    top: 0;
    background: linear-gradient(90deg, var(--name-primary), var(--name-secondary));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    filter: blur(1px) saturate(1.5) hue-rotate(180deg);
    opacity: 0.6;
    z-index: -1;
    animation: noise-shift 4s ease-in-out infinite;
}

@keyframes noise-shift {

    0%,
    100% {
        transform: translate(0, 0);
        filter: blur(1px) saturate(1.5) hue-rotate(180deg);
    }

    25% {
        transform: translate(0.5px, -0.5px);
        filter: blur(1.2px) saturate(1.8) hue-rotate(200deg);
    }

    50% {
        transform: translate(-0.5px, 0.5px);
        filter: blur(0.8px) saturate(1.3) hue-rotate(160deg);
    }

    75% {
        transform: translate(0.3px, 0.3px);
        filter: blur(1px) saturate(1.6) hue-rotate(220deg);
    }
}

.room-text {
    background: linear-gradient(90deg, var(--primary), var(--accent));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    text-shadow: 0 0 8px var(--room-glow-primary), 0 0 16px var(--room-glow-secondary);
    filter: brightness(1.2) saturate(1.3);
}

/* Light theme cyber enhancement */
:root {
    --cyber-glow: rgba(249, 115, 22, 0.3);
    --cyber-accent: rgba(234, 88, 12, 0.25);
    --room-glow-primary: rgba(249, 115, 22, 0.3);
    --room-glow-secondary: rgba(234, 88, 12, 0.2);
    --name-primary: #4f46e5;
    /* indigo-600 */
    --name-secondary: #7c3aed;
    /* violet-600 */
}

.dark {
    --cyber-glow: rgba(0, 209, 255, 0.4);
    --cyber-accent: rgba(57, 255, 20, 0.2);
    --room-glow-primary: rgba(0, 209, 255, 0.3);
    --room-glow-secondary: rgba(57, 255, 20, 0.2);
    --name-primary: #06b6d4;
    /* cyan-500 */
    --name-secondary: #8b5cf6;
    /* violet-500 */
}

.dot-accent {
    color: var(--accent);
    text-shadow: 0 0 6px var(--cyber-accent), 0 0 12px var(--cyber-glow);
    animation: pulse-cyber 3s ease-in-out infinite;
}

@keyframes pulse-cyber {

    0%,
    100% {
        opacity: 0.9;
        text-shadow: 0 0 6px var(--cyber-accent), 0 0 12px var(--cyber-glow);
    }

    50% {
        opacity: 1;
        text-shadow: 0 0 10px var(--cyber-accent), 0 0 20px var(--cyber-glow), 0 0 30px var(--cyber-accent);
    }
}

@keyframes riseIn {
    0% {
        opacity: 0;
        transform: translateY(10px) scale(0.98);
    }

    100% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* パチスロ風虹色アニメーション */
@keyframes rainbow-spin {
    0% {
        background: conic-gradient(from 0deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080, #ff0000);
    }

    25% {
        background: conic-gradient(from 90deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080, #ff0000);
    }

    50% {
        background: conic-gradient(from 180deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080, #ff0000);
    }

    75% {
        background: conic-gradient(from 270deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080, #ff0000);
    }

    100% {
        background: conic-gradient(from 360deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080, #ff0000);
    }
}

@keyframes rainbow-pulse {

    0%,
    100% {
        filter: brightness(1) saturate(1) hue-rotate(0deg);
    }

    33% {
        filter: brightness(1.3) saturate(1.5) hue-rotate(120deg);
    }

    66% {
        filter: brightness(1.1) saturate(1.8) hue-rotate(240deg);
    }
}

@keyframes text-glow {

    0%,
    100% {
        text-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 15px currentColor;
    }

    50% {
        text-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor;
    }
}

.rainbow-border {
    position: relative;
    border-radius: 0.5rem;
    padding: 2px;
    background: conic-gradient(from 0deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080, #ff0000);
    animation: rainbow-spin 3s linear infinite;
}

.rainbow-border::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: conic-gradient(from 0deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080, #ff0000);
    animation: rainbow-spin 3s linear infinite reverse;
    z-index: -1;
    filter: blur(4px);
}

.rainbow-text {
    background: linear-gradient(45deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080);
    background-size: 400% 400%;
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    animation: rainbow-pulse 2s ease-in-out infinite;
    font-weight: 900;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
}

.white-text {
    color: white !important;
    text-shadow: none !important;
    background: none !important;
    -webkit-background-clip: unset !important;
    background-clip: unset !important;
    font-weight: 900;
}

.pachinko-glow {
    animation: text-glow 1.5s ease-in-out infinite;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.1em;
}

/* 入力フィールドとボタンのモバイルでのタップ領域を拡大 */
input,
button,
.link,
a {
    @media (max-width: 768px) {
        font-size: 16px;
        /* iOSの自動ズームを防止 */
        min-height: 44px;
        /* タップ可能エリアを拡大 */
    }
}

.transition-max-height {
    transition: max-height 0.5s ease-in-out;
}

.grid-background {
    @apply bg-gray-50 dark:bg-gray-900;
    // その他のスタイル
}

/* 横スクロール用スクロールバー非表示ユーティリティ */
.no-scrollbar {
    -ms-overflow-style: none;
    /* IE/Edge */
    scrollbar-width: none;
    /* Firefox */
}

.no-scrollbar::-webkit-scrollbar {
    /* Chrome/Safari */
    display: none;
}

@keyframes expand {
    0% {
        width: 0;
        opacity: 0.7;
    }

    100% {
        width: 100%;
        opacity: 1;
    }
}

.animate-expand {
    animation: expand 1.8s cubic-bezier(0.25, 0.1, 0.25, 1) forwards;
}

@keyframes pulse-dot {
    0% {
        opacity: 0.8;
    }

    50% {
        opacity: 1;
    }

    100% {
        opacity: 0.8;
    }
}

.animate-pulse-dot {
    display: inline-block;
    animation: pulse-dot 2s infinite ease-in-out;
}

@keyframes spin-record {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

.animate-record-spin {
    animation: spin-record 20s linear infinite;
}

/* スマートフォンでの遅いアニメーション防止 */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}
